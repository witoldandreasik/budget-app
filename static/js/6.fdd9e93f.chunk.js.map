{"version":3,"sources":["data/fetch/budget.fetch.js","data/fetch/common.fetch.js","data/fetch/index.js","pages/Budget/components/AddTransactionForm/AddTransactionForm.js","pages/Budget/components/AddTransactionForm/AddTransactionView.js"],"names":["fetchBudget","key","a","id","console","log","fetch","process","response","json","data","fetchBudgetedCategories","addTransaction","budgetId","method","headers","body","JSON","stringify","fetchAllCategories","budget","common","required","value","undefined","AddTransactionForm","onSubmit","noop","categories","groupCategoriesBy","groupedCategoriesByParentName","groupBy","categoryItems","useMemo","Object","entries","map","parentName","label","category","name","render","handleSubmit","form","submitting","pristine","values","validate","input","meta","type","placeholder","error","touched","parse","parseFloat","step","className","disabled","onClick","reset","AddTransactionView","useQuery","API","allCategories","useMutation","onSettled","queryCache","refetchQueries","mutate","history","useHistory","then","goBack"],"mappings":"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","file":"static/js/6.fdd9e93f.chunk.js","sourcesContent":["export const fetchBudget = async (key, { id }) => {\r\n  console.log({ id });\r\n  const response = await fetch(\r\n    `${process.env.REACT_APP_API_URL}/budgets/${id}/?_embed=transactions`\r\n  );\r\n  const data = await response.json();\r\n  return data;\r\n};\r\n\r\nexport const fetchBudgetedCategories = async (key, { id }) => {\r\n  const response = await fetch(\r\n    `${process.env.REACT_APP_API_URL}/budgets/${id}/budgetCategories`\r\n  );\r\n  const data = await response.json();\r\n  return data;\r\n};\r\n\r\nexport const addTransaction = async ({ budgetId, data }) => {\r\n  const response = await fetch(\r\n    `${process.env.REACT_APP_API_URL}/budgets/${budgetId}/transactions/`,\r\n    {\r\n      method: \"POST\",\r\n      headers: {\r\n        \"Content-type\": \"application/json\",\r\n      },\r\n      body: JSON.stringify(data),\r\n    }\r\n  );\r\n\r\n  return await response.json();\r\n};\r\n","export const fetchAllCategories = async () => {\r\n  const response = await fetch(\r\n    `${process.env.REACT_APP_API_URL}/categories/?_expand=parentCategory`\r\n  );\r\n  const data = await response.json();\r\n  return data;\r\n};\r\n","import * as budget from \"./budget.fetch\";\r\nimport * as common from \"./common.fetch\";\r\nexport default {\r\n  budget,\r\n  common,\r\n};\r\n","import React, { useMemo } from \"react\";\r\nimport { Form, Field } from \"react-final-form\";\r\nimport { groupBy, noop } from \"lodash\";\r\n\r\nconst required = (value) => (value ? undefined : \"This field is required!\");\r\n\r\nfunction AddTransactionForm({\r\n  onSubmit = noop,\r\n  categories,\r\n  groupCategoriesBy,\r\n}) {\r\n  const groupedCategoriesByParentName = groupCategoriesBy\r\n    ? groupBy(categories, groupCategoriesBy)\r\n    : null;\r\n  const categoryItems = useMemo(\r\n    () =>\r\n      groupedCategoriesByParentName\r\n        ? Object.entries(groupedCategoriesByParentName).map(\r\n            ([parentName, categories]) => (\r\n              <optgroup key={parentName} label={parentName}>\r\n                {categories.map((category) => (\r\n                  <option key={category.id} value={category.id}>\r\n                    {category.name}\r\n                  </option>\r\n                ))}\r\n              </optgroup>\r\n            )\r\n          )\r\n        : categories.map((category) => (\r\n            <option value={category.id}>{category.name}</option>\r\n          )),\r\n    [groupedCategoriesByParentName, categories]\r\n  );\r\n\r\n  return (\r\n    <Form\r\n      onSubmit={onSubmit}\r\n      render={({ handleSubmit, form, submitting, pristine, values }) => (\r\n        <form onSubmit={handleSubmit}>\r\n          <Field name=\"description\" validate={required}>\r\n            {({ input, meta }) => (\r\n              <div>\r\n                <label>Description</label>\r\n                <input {...input} type=\"text\" placeholder=\"Description\" />\r\n                {meta.error && meta.touched && <span>{meta.error}</span>}\r\n              </div>\r\n            )}\r\n          </Field>\r\n          <Field\r\n            name=\"amount\"\r\n            validate={required}\r\n            parse={(value) => parseFloat(value, 10)}\r\n          >\r\n            {({ input, meta }) => (\r\n              <div>\r\n                <label>Amount</label>\r\n                <input\r\n                  {...input}\r\n                  type=\"number\"\r\n                  step=\"0.01\"\r\n                  placeholder=\"Amount\"\r\n                />\r\n                {meta.error && meta.touched && <span>{meta.error}</span>}\r\n              </div>\r\n            )}\r\n          </Field>\r\n          <Field name=\"categoryId\" validate={required}>\r\n            {({ input, meta }) => (\r\n              <div>\r\n                <label>Category</label>\r\n                <select {...input}>{categoryItems}</select>\r\n                {meta.error && meta.touched && <span>{meta.error}</span>}\r\n              </div>\r\n            )}\r\n          </Field>\r\n          <Field name=\"date\" validate={required}>\r\n            {({ input, meta }) => (\r\n              <div>\r\n                <label>Date</label>\r\n                <input {...input} type=\"date\" placeholder=\"Date\" />\r\n                {meta.error && meta.touched && <span>{meta.error}</span>}\r\n              </div>\r\n            )}\r\n          </Field>\r\n\r\n          <div className=\"buttons\">\r\n            <button type=\"submit\" disabled={submitting}>\r\n              Submit\r\n            </button>\r\n            <button\r\n              type=\"button\"\r\n              onClick={form.reset}\r\n              disabled={submitting || pristine}\r\n            >\r\n              Reset\r\n            </button>\r\n          </div>\r\n        </form>\r\n      )}\r\n    />\r\n  );\r\n}\r\n\r\nexport default AddTransactionForm;\r\n","import React from \"react\";\r\n\r\nimport { useQuery, useMutation, queryCache } from \"react-query\";\r\nimport { useHistory } from \"react-router-dom\";\r\nimport AddTransactionForm from \"./AddTransactionForm\";\r\nimport API from \"data/fetch\";\r\n\r\nfunction AddTransactionView({ addTransaction }) {\r\n  const { data: budget } = useQuery(\r\n    [\"budget\", { id: 1 }],\r\n    API.budget.fetchBudget\r\n  );\r\n  const { data: allCategories } = useQuery(\r\n    \"allCategories\",\r\n    API.common.fetchAllCategories\r\n  );\r\n  const [mutate] = useMutation(API.budget.addTransaction, {\r\n    onSettled: () => queryCache.refetchQueries(\"budget\", { id: 1 }),\r\n  });\r\n\r\n  const history = useHistory();\r\n\r\n  const handleSubmitAddTransaction = (values) => {\r\n    mutate({ budgetId: budget.id, data: values }).then(() => {\r\n      history.goBack();\r\n    });\r\n  };\r\n\r\n  return (\r\n    <AddTransactionForm\r\n      categories={allCategories}\r\n      groupCategoriesBy=\"parentCategory.name\"\r\n      onSubmit={handleSubmitAddTransaction}\r\n    />\r\n  );\r\n}\r\n\r\nexport default AddTransactionView;\r\n"],"sourceRoot":""}